'use strict';
var _extends =
    Object.assign ||
    function (e) {
      for (var t = 1; t < arguments.length; t++) {
        var r = arguments[t];
        for (var n in r) Object.prototype.hasOwnProperty.call(r, n) && (e[n] = r[n]);
      }
      return e;
    },
  security = (function (e) {
    var t = function () {
        (this.Config = { debug: '@DEBUG@', packages: {}, fns: {}, forceAssetsHost: void 0 }),
          (this.waterMarkConfig = {
            markLayout: '',
            queryKey: 'userName',
            style: '',
            className: '',
            markStyle: '',
            markClassName: '',
            markID: '__security_watermark_sk',
            zIndex: 99999,
            gapX: 312,
            gapY: 222,
            width: 120,
            height: 64,
            rotate: -22,
            image: '',
            content: '',
            subContent: '',
            offsetLeft: 0,
            offsetTop: 0,
            fontStyle: 'normal',
            fontWeight: 'normal',
            fontColor: 'rgba(0,0,0,.12)',
            fontSize: 16,
            fontFamily: 'sans-serif',
            prefixCls: 'base-layout-watermark',
          });
        var e = function (e, t) {
            if (!e) return '';
            var r = e.replace(/^[\s\xa0]+|[\s\xa0]+$/g, '');
            return t && (r = r.replace(/\s/g, '')), r;
          },
          t = function (t, r, n) {
            if (void 0 === r) {
              var i = null;
              if (document.cookie && '' !== document.cookie)
                for (var o = document.cookie.split(';'), a = 0; a < o.length; a++) {
                  var s = e(o[a]);
                  if (s.substring(0, t.length + 1) === t + '=') {
                    i = decodeURIComponent(s.substring(t.length + 1));
                    break;
                  }
                }
              return i;
            }
            (n = n || {}), null === r && ((r = ''), (n = _extends({}, n)), (n.expires = -1));
            var c = '';
            if (n.expires && ('number' == typeof n.expires || n.expires.toUTCString)) {
              var l;
              'number' == typeof n.expires
                ? ((l = new Date()), l.setTime(l.getTime() + 24 * n.expires * 60 * 60 * 1e3))
                : (l = n.expires),
                (c = '; expires=' + l.toUTCString());
            }
            var f = n.path ? '; path=' + n.path : ';path=/',
              u = n.domain ? '; domain=' + n.domain : '',
              p = n.secure ? '; secure' : '';
            document.cookie = [t, '=', encodeURIComponent(r), c, f, u, p].join('');
          };
        (this.Utils = { trim: e, cookie: t }), (this.waterMark = {}), this.initWaterMark();
      },
      r = function () {
        var e = this,
          t = function (e) {
            if (!e) return 1;
            var t =
              e.backingStorePixelRatio ||
              e.webkitBackingStorePixelRatio ||
              e.mozBackingStorePixelRatio ||
              e.msBackingStorePixelRatio ||
              e.oBackingStorePixelRatio ||
              e.backingStorePixelRatio ||
              1;
            return (window.devicePixelRatio || 1) / t;
          },
          r = function (t) {
            var r = e.waterMarkConfig,
              n = r.markLayout,
              i = r.style,
              o = r.className,
              a = r.markStyle,
              s = r.markClassName,
              c = r.markID,
              l = r.zIndex,
              f = r.gapX,
              u = r.width,
              p = r.prefixCls,
              g = p + '-wrapper ' + o,
              m = p + ' ' + s,
              d = n || document.body,
              y = g.split(' ').filter(function (e) {
                return !!e;
              });
            d &&
              y.map(function (e) {
                return d.classList.add(e);
              }),
              (d.style.cssText = d.style.cssText + ' ' + i);
            var k = document.body.querySelector('#' + c),
              x = document.createElement('div'),
              w = m.split(' ').filter(function (e) {
                return !!e;
              });
            (x.id = c),
              w.map(function (e) {
                return x.classList.add(e);
              }),
              (x.style.zIndex = l),
              (x.style.position = 'fixed'),
              (x.style.left = 0),
              (x.style.top = 0),
              (x.style.width = '100%'),
              (x.style.height = '100%'),
              (x.style.backgroundSize = f + u + 'px'),
              (x.style.backgroundImage = "url('" + t + "')"),
              (x.style.pointerEvents = 'none'),
              (x.style.top = 0),
              (x.style.cssText = x.style.cssText + ' ' + a),
              !!k && k.parentElement.removeChild(k),
              d.appendChild(x);
          },
          n = function (n) {
            e.config = _extends({}, e.waterMarkConfig, n);
            var i = e.config,
              o = i.gapX,
              a = i.gapY,
              s = i.width,
              c = i.height,
              l = i.rotate,
              f = i.image,
              u = i.content,
              p = i.subContent,
              g = i.offsetLeft,
              m = i.offsetTop,
              d = i.fontStyle,
              y = i.fontWeight,
              k = i.fontColor,
              x = i.fontSize,
              w = i.fontFamily;
            e.cookieContent !== u &&
              (e.Utils.cookie('__security_waterMark_info', u), (e.cookieContent = u));
            var h = document.createElement('canvas'),
              v = h.getContext('2d'),
              b = t(v),
              C = (o + s) * b + 'px',
              _ = (a + c) * b + 'px',
              S = g || o / 2,
              M = m || a / 2;
            if ((h.setAttribute('width', C), h.setAttribute('height', _), v)) {
              v.translate(S * b, M * b), v.rotate((Math.PI / 180) * Number(l));
              var T = s * b,
                I = c * b;
              if (f) {
                var R = new Image();
                (R.crossOrigin = 'anonymous'),
                  (R.referrerPolicy = 'no-referrer'),
                  (R.src = f),
                  (R.onload = function () {
                    v.drawImage(R, 0, 0, T, I), r(h.toDataURL());
                  });
              } else {
                var P = Number(x) * b;
                u &&
                  ((v.font = d + ' normal ' + y + ' ' + P + 'px/' + I + 'px ' + w),
                  (v.fillStyle = k),
                  (v.textAlign = 'center'),
                  v.fillText(u, 0, 0)),
                  p &&
                    ((v.font = d + ' normal ' + y + ' ' + 0.75 * P + 'px/' + I + 'px ' + w),
                    (v.fillStyle = k),
                    v.fillText(p, 0, 30)),
                  r(h.toDataURL());
              }
            } else console.error('当前环境不支持Canvas');
          };
        (this.waterMark.config = this.waterMarkConfig),
          (this.waterMark.update = function () {
            return n;
          }),
          (this.waterMark.set = function (e) {
            return n({ content: e });
          });
      };
    return (t.prototype.initWaterMark = r), (t.prototype.version = '4.0.39'), t;
  })();
!(function (e) {
  var t = function () {};
  (e.prototype.init = t),
    (window.g_security = e = new e()),
    (window.g_waterMark = window.g_security.waterMark);
  var r = window.g_security.Utils.cookie('__security_waterMark_info'),
    n = g_waterMark.config || {},
    i = n.content;
  g_waterMark.set(r || i);
})(security);
